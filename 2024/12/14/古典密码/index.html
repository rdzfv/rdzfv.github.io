<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="xyy">





<title>古典密码 | xyy爱吃番茄（个人分享）</title>



    <link rel="icon" href="https://qiniu.xuyuyan.cn/XYY.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">xyy爱吃番茄！(个人分享)</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">文章</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="/about">关于我</a>
                
                    <a class="menu-item" href="/friends">友链</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">xyy爱吃番茄！(个人分享)</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">文章</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="/about">关于我</a>
                
                    <a class="menu-item" href="/friends">友链</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">古典密码</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">xyy</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">十二月 14, 2024&nbsp;&nbsp;9:20:24</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/CTF/">CTF</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>古典密码是密码学的一个类型，大部分加密方式是利用替换密码或者移项密码。在历史上曾被普遍使用，但因其简单特性，到了现代密码时代几乎不可信赖。</p>
<h2 id="1-线性映射"><a href="#1-线性映射" class="headerlink" title="1. 线性映射"></a>1. 线性映射</h2><h3 id="1-1-凯撒密码"><a href="#1-1-凯撒密码" class="headerlink" title="1.1 凯撒密码"></a>1.1 凯撒密码</h3><p>凯撒密码是一种替换加密技术，明文中的所有字母都在字母表上向后/向前安宅一个固定数目进行偏移后替换成密文。以下是凯撒密码的加密和解密公式，其中 $x$ 为待操作的文本， $n$ 为密钥（即偏移量）：</p>
<p>$E_n(x)=(x+n)mod 26$</p>
<p>$D_n(x)=(x-n)mod 26$</p>
<p>因此，即使使用<strong>唯密文攻击</strong>，凯撒密码也是一种非常容易破解的加密方式。当我们猜测密文中使用了某个简单的替换加密方式，但不确定是否是凯撒密码时，可以使用诸如频率分析或者样式单词分析的方法，从结果中看出规律。</p>
<blockquote>
<p>🙋：什么是唯密文攻击？</p>
<p>唯密文攻击（Ciphertext-Only Attack，简称COA）是一种密码分析方法，在这种攻击中，攻击者只能获取到加密后的密文，而没有加密算法的密钥、明文或明文-密文对等辅助信息。攻击者试图仅通过分析密文来推断明文或加密密钥。</p>
</blockquote>
<p>下面举一个凯撒密码破译的例子，假设我们收到了这样一串密文 <code>GSV XLWV RH ZOO ZMW GSV ZIV RH YVNV</code>。</p>
<p>第一步是频率分析：<code>G: 4, S: 4, V: 5, X: 1, L: 1, W: 2, R: 2, H: 1, Z: 3, M: 1, I: 2, Y: 1, N: 1</code>，观察到：<code>V</code> 是出现频率最高的字母，出现了 5 次。按照经验，英语中最常见的字母是 <code>E</code>。因此，我们初步猜测 <code>V</code> 可能对应 <code>E</code>。</p>
<p>第二步是尝试解密偏移量，<code>V</code> → <code>E</code>，则偏移量为 5（<code>V</code> 到 <code>E</code>向前移动 5），使用偏移量 5 对密文解密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文：    GSV XLWV RH ZOO ZMW GSV ZIV RH YVNV</span><br><span class="line">偏移 -5： THE QUICK IS ALL AND THE FOX IS DEAD</span><br></pre></td></tr></table></figure>

<p>第三步是分析解密后的单词样式和语言规律，确认推测结果</p>
<ul>
<li>XLWV 解密为 QUICK，是一个常见的单词，符合逻辑。</li>
<li>ZOO 解密为 ALL，也是合理的。</li>
<li>ZIV 解密为 FOX，常见词语。</li>
<li>整句明文符合英语语法和上下文逻辑。</li>
</ul>
<p>凯撒加密的危险性在于，当我们知道或猜测密文使用了凯撒密码，使用穷举法就能破解偏移量。因为一般使用凯撒加密都是英文，仅有26个英文字母，偏移量最大为25，可以通过穷举的方式轻易破解。</p>
<h3 id="1-2-维吉尼亚密码"><a href="#1-2-维吉尼亚密码" class="headerlink" title="1.2 维吉尼亚密码"></a>1.2 维吉尼亚密码</h3><p>维吉尼亚密码是使用一系列凯撒密码组成密码字母表的加密算法。</p>
<p>让我们通过一个例子来了解维吉尼亚密码的加密过程：假设明文为 <code>ATTACKATDAWN</code>，密钥为 <code>LEMON</code>。首先循环密钥使之成为密钥流，长度和明文长度相同，即 <code>LEMONLEMONLE</code>。然后根据每一位密钥对明文进行加密，第一位密钥为 <code>L</code> 是第12个字母，则偏移量为（12-1），对于第一位明文 <code>A</code> ，加密后的密文应为 <code>（A+11）mod 26</code>，反复操作。</p>
<p>一般破解维吉尼亚密码有一定的套路：寻找密文中相同连续的字符串。下面我们举一个例子：<code>ZICVTWQNGRZGVTWAVZHCQYGLMGJ</code> 这是用维吉尼亚密码加密的密文，但密钥长度和明文未知。</p>
<p>第一步是寻找密文中的重复模式，<code>卡西斯基测试法</code>：寻找密文中的<strong>重复子字符串</strong>及其间隔。观察密文，发现以下重复片段：</p>
<ol>
<li>VTW 出现两次，第一次在第 3-5 个字母，第二次在第 12-14 个字母。间隔为 9。</li>
<li>GVT 也出现两次，间隔为 15。</li>
</ol>
<p>因此，密钥长度可能是这些间隔的最大公约数。间隔为 9 和 15，最大公约数：3，因此推测密钥长度为 3。</p>
<p>第二步是分组分析，根据密钥长度 3，将密文分成 3 组，每组对应密钥的一个字母，每组分别是用密钥的某一字母加密的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ZICVTWQNGRZGVTWAVZHCQYGLMGJ</span><br><span class="line">组 1: Z   V   Q   Z   V   Z   G</span><br><span class="line">组 2: I   T   N   G   T   H   L</span><br><span class="line">组 3: C   W   G   R   W   C   M</span><br></pre></td></tr></table></figure>

<p>第三步是对每组进行频率分析，假设明文是英语（以 E 为最常见字母），通过频率分析来推测偏移量。</p>
<p><strong>组 1（Z V Q Z V Z G）</strong> 统计字母出现频率：Z: 3 次，V: 2 次，其余各 1 次。</p>
<p>假设 Z 对应明文中的 E，偏移量为：Z → E，偏移量 = (Z - E) mod 26 = (25 - 4) mod 26 = 21</p>
<p><strong>组 2（I T N G T H L）</strong> 统计字母出现频率：T: 2 次，其余各 1 次。</p>
<p>假设 T 对应明文中的 E，偏移量为：T → E，偏移量 = (T - E) mod 26 = (19 - 4) mod 26 = 15</p>
<p><strong>组 3（C W G R W C M）</strong> 统计字母出现频率：W: 2 次，其余各 1 次。</p>
<p>假设 W 对应明文中的 E，偏移量为：W → E，偏移量 = (W - E) mod 26 = (22 - 4) mod 26 = 18</p>
<p>第四步是根据推测的密钥尝试解密，推测密钥为 VPT（对应偏移量 21, 15, 18）。</p>
<p>密文第 1 个字母 Z 对应密钥第 1 个字母 V，解密：(Z - V) mod 26 = (25 - 21) mod 26 = 4 → 明文 E。</p>
<p>逐字母解密，可以得到明文：ENCRYPTEDMESSAGEEXAMPLE</p>
<blockquote>
<p><code>卡西斯基测试法</code>原理：如果相同的明文片段落在相同的密钥位置上，其加密结果将完全一致。</p>
<p>因为维吉尼亚密码的加密方式中，密钥循环使用；而作为明文的英语文法中也多有重复单词，因此有概率会出现相同的明文片段落在相同的密钥位置上的情况。找到多处重复片段的间隔后，取其最大公约数，则可能是密钥的长度。</p>
<p>局限性：    </p>
<ol>
<li><strong>密文长度不足</strong>：如果密文过短，重复片段可能不足以推测密钥长度。</li>
<li><strong>重复片段的偶然性</strong>：重复片段可能是明文中重复内容造成的，而非密钥周期引起。</li>
<li><strong>频率分析依赖语言特性</strong>：密钥长度确定后，解密过程中依赖于目标语言的字母频率分布。</li>
</ol>
</blockquote>
<h2 id="2-固定替换"><a href="#2-固定替换" class="headerlink" title="2. 固定替换"></a>2. 固定替换</h2><h3 id="2-1-培根密码"><a href="#2-1-培根密码" class="headerlink" title="2.1 培根密码"></a>2.1 培根密码</h3><p>培根密码是一种隐写技术，加密时明文中的每个字母都会转换成一组5个字符（二元密码，如 a 或 b）。</p>
<p>假设明文为 <code>HELLO</code>， 有如下二元表：</p>
<table>
<thead>
<tr>
<th>字母</th>
<th>编码</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>aaaaa</td>
</tr>
<tr>
<td>B</td>
<td>aaaab</td>
</tr>
<tr>
<td>C</td>
<td>aaaba</td>
</tr>
<tr>
<td>D</td>
<td>aaabb</td>
</tr>
<tr>
<td>E</td>
<td>aabaa</td>
</tr>
<tr>
<td>H</td>
<td>aabbb</td>
</tr>
<tr>
<td>L</td>
<td>ababa</td>
</tr>
<tr>
<td>O</td>
<td>abbab</td>
</tr>
</tbody></table>
<p>则明文可以加密为：<code>aabbbaabaaababababbab</code>。</p>
<p>但是，如果明文仅由两元密码组成，很容易被猜测出是培根密码。因此可以对密文进行伪装，如伪装成一段有意义的英文句子，长度和密文相同，但是使用大写、小写来区分<code>a</code> 和 <code>b</code>。</p>
<p>但是对于经验丰富的破译者来说还是小菜一碟～</p>
<h2 id="3-移位密码"><a href="#3-移位密码" class="headerlink" title="3. 移位密码"></a>3. 移位密码</h2><h3 id="3-1-栅栏密码"><a href="#3-1-栅栏密码" class="headerlink" title="3.1 栅栏密码"></a>3.1 栅栏密码</h3><p>栅栏密码是要把加密的明文分成每N个一组，然后把每组的第一个字符连接起来，形成一段无规律字符串。</p>
<p>假设我们要加密明文：<code>HELLO WORLD</code></p>
<p>第一步，去掉空格，变成 <code>HELLOWORLD</code></p>
<p>第二步，选择栅栏的行数 $n$（密钥），并改写成 $n$ 行。假设密钥为3，按如下方式排列字符：</p>
<ul>
<li>第一行：从左到右写第 1 个字母，再隔两行写第 4、7、10 个字母，依此类推。</li>
<li>第二行：从左到右写第 2、5、8 个字母，依此类推。</li>
<li>第三行：从左到右写第 3、6、9 个字母，依此类推</li>
</ul>
<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">H  O  L  D</span><br><span class="line"> E L W R</span><br><span class="line">  L   O</span><br></pre></td></tr></table></figure>

<p>第四步，逐行读取字符，得到 <code>HOLDELWRLO</code>。</p>
<p>常见的破解方法就是爆破，枚举栅栏行数从 $2$ 到 $n/2$，按栅栏密码的解密方法重建原文，逐个检查是否有可读的明文。</p>
<h3 id="3-2-曲路密码"><a href="#3-2-曲路密码" class="headerlink" title="3.2 曲路密码"></a>3.2 曲路密码</h3><p>曲路密码的密钥是整个表格的列数和曲路路径。下面举一个🌰，假设明文为 <code>DEFEND THE EAST WALL</code></p>
<p>第一步，去掉空格，得到 <code>DEFENDTHEEASTWALL</code></p>
<p>第二步，构建网格，设定网格的行数和列数（即密钥的一部分）。假设我们选择 4 行 5 列，将明文按行填入网格（不足使用 <code>X</code> 补齐）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D  E  F  E  N</span><br><span class="line">D  T  H  E  E</span><br><span class="line">A  S  T  W  A</span><br><span class="line">L  L  X  X  X</span><br></pre></td></tr></table></figure>

<p>第三步，选择读取路径。假设选择螺旋顺时针路径，读取顺序如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D → E → F → E → N →</span><br><span class="line">E → X → X → X → L →</span><br><span class="line">A → S → T → W → A →</span><br><span class="line">E → T → H → D → L</span><br></pre></td></tr></table></figure>

<p>第四步，生成密文。按照路径顺序读取字符，得到：<code>DEFENXXXLASTWATHEDL</code></p>
<p>破解的思路仍然是爆破，但是由于网格的行列数未知，读取路径变化多样，破译有一定的难度。</p>
<p>但是能够爆破的话，也算是个基础简单的加密了～</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>xyy</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://www.xuyuyan.cn/2024/12/14/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">http://www.xuyuyan.cn/2024/12/14/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/</a></span>
                    </p>
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/CTF/"># CTF</a>
                    
                        <a href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/"># 古典密码</a>
                    
                        <a href="/tags/%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81/"># 凯撒密码</a>
                    
                        <a href="/tags/%E7%BA%BF%E5%BD%A2%E6%98%A0%E5%B0%84/"># 线形映射</a>
                    
                        <a href="/tags/%E5%9B%BA%E5%AE%9A%E6%9B%BF%E6%8D%A2/"># 固定替换</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2024/11/23/APK/">APK</a>
            
        </section>


    </article>
</div>


    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="//unpkg.com/gitalk/dist/gitalk.css">
<script src="//unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
      var gitalk = new Gitalk({
        clientID: '4283629b368b1cf98f81',
        clientSecret: '8bb6ce27010c0db8286e943f3765aeae1757de4d',
        repo: 'xyyBlog',
        owner: 'rdzfv',
        admin: 'rdzfv',
        id: md5(location.pathname),      
        labels: 'Gitalk'.split(',').filter(l => l),
        perPage: 10,
        pagerDirection: 'last',
        createIssueManually: true,
        distractionFreeMode: true
      })
      gitalk.render('gitalk-container')
</script>



        </div>
        <footer id="footer" class="footer">
   <div class="copyright">
    <div style="position:fixed;left:8%;bottom:5%;">
        <div id="webpushr-subscription-button" data-button-text="订阅本站" data-subscriber-count-text="人已订阅" data-background-color="#000000"></div>
    </div>
    <div style="display:inline-block;">
        <div> <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" style="text-decoration: none;color: black;" >浙ICP备19012712号</a> </div>
        <span>© xyy | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
